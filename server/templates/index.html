<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoCheckin - 企业微信自动打卡</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>企业微信自动打卡</h1>
            <div id="connection-status" class="status-badge offline">
                <span class="dot"></span>
                <span id="conn-text">手机离线</span>
            </div>
        </header>

        <!-- Device Info Card -->
        <div class="card" id="device-card">
            <h2>设备状态</h2>
            <div class="device-info">
                <div class="info-item">
                    <span class="label">电量</span>
                    <span id="battery" class="value">--</span>
                </div>
                <div class="info-item">
                    <span class="label">WiFi</span>
                    <span id="wifi-ssid" class="value">--</span>
                </div>
                <div class="info-item">
                    <span class="label">IP</span>
                    <span id="wifi-ip" class="value">--</span>
                </div>
                <div class="info-item">
                    <span class="label">ADB</span>
                    <span id="adb-status" class="value">--</span>
                </div>
                <div class="info-item">
                    <span class="label">心跳</span>
                    <span id="last-heartbeat" class="value">--</span>
                </div>
            </div>
        </div>

        <!-- Today's Checkin Status -->
        <div class="card">
            <h2>今日打卡</h2>
            <div class="checkin-status">
                <div class="checkin-item" id="morning-checkin">
                    <div class="checkin-icon" id="morning-icon">?</div>
                    <div class="checkin-label">上班打卡</div>
                    <div class="checkin-time" id="morning-time">未打卡</div>
                </div>
                <div class="checkin-item" id="evening-checkin">
                    <div class="checkin-icon" id="evening-icon">?</div>
                    <div class="checkin-label">下班打卡</div>
                    <div class="checkin-time" id="evening-time">未打卡</div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="card">
            <h2>操作</h2>
            <div class="actions">
                <button id="btn-checkin-morning" class="btn btn-primary" onclick="triggerCheckin('上班')">
                    上班打卡
                </button>
                <button id="btn-checkin-evening" class="btn btn-primary" onclick="triggerCheckin('下班')">
                    下班打卡
                </button>
                <button id="btn-screenshot" class="btn btn-secondary" onclick="requestScreenshot()">
                    截图
                </button>
            </div>
            <div id="action-msg" class="action-message"></div>
        </div>

        <!-- Screenshot -->
        <div class="card" id="screenshot-card" style="display:none">
            <h2>最新截图</h2>
            <img id="screenshot-img" class="screenshot" src="" alt="截图">
            <div id="screenshot-time" class="screenshot-time"></div>
        </div>

        <!-- Schedule Config -->
        <div class="card">
            <h2>打卡时间配置</h2>
            <div class="schedule-form">
                <div class="form-group">
                    <label>上班打卡时间</label>
                    <input type="time" id="cfg-morning" value="08:30">
                </div>
                <div class="form-group">
                    <label>下班打卡时间</label>
                    <input type="time" id="cfg-evening" value="18:30">
                </div>
                <div class="form-group">
                    <label>最大随机延时 (秒)</label>
                    <input type="number" id="cfg-delay" value="900" min="0" max="3600">
                </div>
                <div class="form-group checkbox-group">
                    <label><input type="checkbox" id="cfg-weekends" checked> 跳过周末</label>
                    <label><input type="checkbox" id="cfg-holidays" checked> 跳过节假日</label>
                </div>
                <button class="btn btn-primary" onclick="saveSchedule()">保存配置</button>
            </div>
        </div>

        <!-- History -->
        <div class="card">
            <h2>打卡历史</h2>
            <div class="history-controls">
                <select id="history-days" onchange="loadHistory()">
                    <option value="3">最近3天</option>
                    <option value="7" selected>最近7天</option>
                    <option value="30">最近30天</option>
                </select>
            </div>
            <div class="table-wrap">
                <table id="history-table">
                    <thead>
                        <tr>
                            <th>时间</th>
                            <th>类型</th>
                            <th>结果</th>
                            <th>触发</th>
                            <th>消息</th>
                        </tr>
                    </thead>
                    <tbody id="history-body">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Log -->
        <div class="card">
            <h2>实时日志</h2>
            <div id="log-area" class="log-area"></div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
